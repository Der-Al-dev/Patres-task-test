# README

Created: May 28, 2025 11:12 PM

Структура проекта
```
├── app
│   ├── **init**.py
│   ├── alembic
│   │   ├── README
│   │   ├── [env.py](http://env.py/)
│   │   ├── script.py.mako
│   │   └── versions
│   │       ├── e2615d975559_initial.py
│   │       └── e66344cec24d_add_genre_field_to_books.py
│   ├── alembic.ini
│   ├── book_db_management_app.py - управление книгами (CRUD)
│   ├── bookkeeping_app.py - управление выдачей/приемом книг
│   ├── config_app.py - хранение глобальных констант
│   ├── [database.py](http://database.py/) - 
│   ├── [dependencies.py](http://dependencies.py/)
│   ├── init_db_app.py - для создания БД и первого библиотекаря
│   ├── librarian_db_management_app.py - управление библиотекарями
│   ├── [main.py](http://main.py/) - вход в приложение
│   ├── [models.py](http://models.py/) - модели
│   ├── reader_db_management_app.py
│   └── [schemas.py](http://schemas.py/) проверка моделей 
├── data
│   └── для записи сюда library.db
├── materials
│   └── Тестовое Задание для Стажера Python-Разработчика A .md
├── pyproject.toml  - сборка тестов
├── requirements.txt - основные зависимости
├── [setup.py](http://setup.py/)
└── tests - тесты для проверки
    ├── [conftest.py](http://conftest.py/)
    ├── test_api_integration.py
    ├── test_auth.py
    ├── test_business_logic.py
    └── test_init_db.py
```
➡️ Запуск приложения - uvicorn main:app --reload

➡️ Первый пользователь и база данных создается запуском python3 init_db.py.  База данных расположена - /data/library.db

⚠️ создавать библиотекарей могут только библиотекари - после авторизации
➡️ структура БД содержит таблицы:
 - books для хранения данных о книгах
 - users для хранения данных о библиотекарях
 - readers для хранения данных о читателях
 - borrowed_books для хранения данных о выданных книгах
➡️ При выдаче книги проверяется что экземпляров книги больше чем 0 и что у данного читателя не более 3 книг на руках (реализовано через запросы в БД), в БД фиксируется соответствующее уменьшение/увеличение количества экземпляров книги при выдаче/возврате. При возврате проверяется, что книга была действительно выдана. Все проверки читателя и книги проводятся по id (генерируется автоматически)
➡️ токен генерируется при авторизации библиотекаря, JWT защищены эндпоинты:
 - регистрация нового библиотекаря (т.к. он имеет доступ к БД)
 - все действия с изменениями в БД книг (в т.ч. выданных), читателей, библиотекарей, т.к. это соответствует принятым в данной отрасли правилам. За исключением того, что библиотекарей должны регистрировать библиотекари - в данном случае использовано упрощение бизнес-логики, т.к. нет требований в задании

**Фича:** Можно дополнительно реализовать отправку сообщений пользователям, которые берут книги определенного жанра:
1. Добавить к модели Book параметр жанр (уже сделано для второй миграции alembic)
2. Добавить функцию которая будет формировать данные о предпочтениях пользователя в соответствии с жанром
3. При поступлении новых книг в жанре, соответствующем предпочтениям пользователя,  отправлять письмо на почту пользователю сообщения с данной информацией.
Это позволит увеличить КПД основной функции библиотеки - книгооборот.